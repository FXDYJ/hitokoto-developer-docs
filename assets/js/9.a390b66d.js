(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{374:function(t,v,_){"use strict";_.r(v);var s=_(27),a=Object(s.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"核心接口"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#核心接口"}},[t._v("#")]),t._v(" 核心接口")]),t._v(" "),_("h2",{attrs:{id:"简介"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),_("p",[t._v("一言核心接口是萌创团队在开发过程中，暴露给外部环境，方便开发的系列接口。它们实现了：")]),t._v(" "),_("ul",[_("li",[t._v("用户操作")]),t._v(" "),_("li",[t._v("句子操作")]),t._v(" "),_("li",[t._v("评分操作")]),t._v(" "),_("li",[t._v("举报操作")])]),t._v(" "),_("p",[t._v("的功能。目前，这些接口可通过无状态模型使用。")]),t._v(" "),_("h2",{attrs:{id:"接口地址"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#接口地址"}},[t._v("#")]),t._v(" 接口地址")]),t._v(" "),_("p",[t._v("核心接口实现了两套认证机制，分别对应两个入口：")]),t._v(" "),_("ul",[_("li",[t._v("无状态服务： "),_("a",{attrs:{href:"https://hitokoto.cn/api/restful/v1",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hitokoto.cn/api/restful/v1"),_("OutboundLink")],1)]),t._v(" "),_("li",[t._v("会话认证："),_("a",{attrs:{href:"https://hitokoto.cn/api/common/v1",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hitokoto.cn/api/common/v1"),_("OutboundLink")],1)])]),t._v(" "),_("blockquote",[_("p",[t._v("基于会话认证的接口的最初目的是便于前端调用，因此具备 CSRF 验证，不适合开发者使用。")])]),t._v(" "),_("h2",{attrs:{id:"约束"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#约束"}},[t._v("#")]),t._v(" 约束")]),t._v(" "),_("blockquote",[_("p",[t._v("接下来，我们便以 "),_("strong",[t._v("无状态")]),t._v(" 接口作为入口进行讲解。")])]),t._v(" "),_("h3",{attrs:{id:"认证方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#认证方式"}},[t._v("#")]),t._v(" 认证方式")]),t._v(" "),_("p",[t._v("无状态服务通过令牌（"),_("code",[t._v("token")]),t._v("）认证，因此每个需要验权的接口，其请求必须包含 "),_("code",[t._v("token")]),t._v(" 字段。\n目前支持三种验证方式：")]),t._v(" "),_("ul",[_("li",[t._v("请求参数，形如： "),_("code",[t._v("?token=xxxxx")])]),t._v(" "),_("li",[t._v("POST 参数（表单），例如：在 POST 表单中添加 "),_("code",[t._v('<input type="hidden" name="token" value="xxxx" >')])]),t._v(" "),_("li",[_("code",[t._v("bearer")]),t._v(" 授权")])]),t._v(" "),_("h3",{attrs:{id:"返回约束"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#返回约束"}},[t._v("#")]),t._v(" 返回约束")]),t._v(" "),_("p",[t._v("返回结构以方便，可快捷测试，方便检验为目标。以下为参数的约束：")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("参数")]),t._v(" "),_("th",[t._v("例子")]),t._v(" "),_("th",[t._v("定义")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("status")]),t._v(" "),_("td",[t._v("200")]),t._v(" "),_("td",[t._v("状态码。正整数定义符合 HTTP 状态码约束，自定义错误为负值。请注意，由于偷懒，目前错误码存在重复定义，请以具体接口为准。")])]),t._v(" "),_("tr",[_("td",[t._v("message")]),t._v(" "),_("td",[t._v('"ok."')]),t._v(" "),_("td",[t._v("信息，当状态码不为 200 时，补充说明错误的字段。")])]),t._v(" "),_("tr",[_("td",[t._v("data")]),t._v(" "),_("td",[t._v("[]")]),t._v(" "),_("td",[t._v("当状态码为 200 时，且接口不为无返回接口，该字段会返回一个长度大于等于 1 的数组；400 状态码下可能包含校验器的报错信息；其余时候为空数组")])]),t._v(" "),_("tr",[_("td",[t._v("ts")]),t._v(" "),_("td",[t._v("1581759895072")]),t._v(" "),_("td",[t._v("接口时间戳，可用于时间比对")])])])]),t._v(" "),_("p",[t._v("下面是一个示例：\n"),_("code",[t._v("GET")]),t._v(" "),_("code",[t._v("https://hitokoto.cn/api/restful/v1/hitokoto/62c12303-b3fa-4720-a7c5-2985bf049e60?token=xxx")])]),t._v(" "),_("div",{staticClass:"language-json line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-json"}},[_("code",[_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok."')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hitokoto"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"过去都是假的，回忆是一条没有归途的路，以往的一切春天都无法复原，即使最狂热最坚贞的爱情，归根结底也不过是一种瞬息即逝的现实，唯有孤独永恒。"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uuid"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"62c12303-b3fa-4720-a7c5-2985bf049e60"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"from"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"百年孤独"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"from_who"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"creator"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"戎歌"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"creator_uid"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("1195")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reviewer"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit_from"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"web"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"created_at"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1532672964"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accept"')]),t._v("\n    "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("1582053586728")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br"),_("span",{staticClass:"line-number"},[t._v("6")]),_("br"),_("span",{staticClass:"line-number"},[t._v("7")]),_("br"),_("span",{staticClass:"line-number"},[t._v("8")]),_("br"),_("span",{staticClass:"line-number"},[t._v("9")]),_("br"),_("span",{staticClass:"line-number"},[t._v("10")]),_("br"),_("span",{staticClass:"line-number"},[t._v("11")]),_("br"),_("span",{staticClass:"line-number"},[t._v("12")]),_("br"),_("span",{staticClass:"line-number"},[t._v("13")]),_("br"),_("span",{staticClass:"line-number"},[t._v("14")]),_("br"),_("span",{staticClass:"line-number"},[t._v("15")]),_("br"),_("span",{staticClass:"line-number"},[t._v("16")]),_("br"),_("span",{staticClass:"line-number"},[t._v("17")]),_("br"),_("span",{staticClass:"line-number"},[t._v("18")]),_("br"),_("span",{staticClass:"line-number"},[t._v("19")]),_("br"),_("span",{staticClass:"line-number"},[t._v("20")]),_("br")])]),_("blockquote",[_("p",[_("strong",[t._v("请注意: 接口会尽量使 HTTP 状态码为 200，但是由于上游中间件的问题，会出现 HTTP 不为 200 的情况，需要开发者自行处理。")])])]),t._v(" "),_("h2",{attrs:{id:"接口方法"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#接口方法"}},[t._v("#")]),t._v(" 接口方法")]),t._v(" "),_("p",[t._v("本节将提供目前暴露的接口表，方便快速查询。")]),t._v(" "),_("blockquote",[_("p",[_("strong",[t._v("请求头请添加 "),_("code",[t._v("Accept: application/json")]),t._v(" 以保证接口输出一定是 JSON。")]),_("br"),t._v("\n由于 Laravel 底层对 PUT 方法的支持不好，提交 PUT 参数时一定要以 "),_("code",[t._v("x-www-form-urlencoded")]),t._v(" 方法提交参数。"),_("br"),t._v("\n或者，你可以使用 "),_("code",[t._v("POST")]),t._v(" 方法，额外添加一个字段 "),_("code",[t._v('_method: "PUT"')]),t._v(" 模拟 PUT 请求。")])]),t._v(" "),_("h3",{attrs:{id:"用户部分"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#用户部分"}},[t._v("#")]),t._v(" 用户部分")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("地址")]),t._v(" "),_("th",[t._v("方法")]),t._v(" "),_("th",[t._v("鉴权")]),t._v(" "),_("th",[t._v("无返回")]),t._v(" "),_("th",[t._v("备注")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("/auth/login")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("登录接口，成功返回用户信息（包含令牌）")])]),t._v(" "),_("tr",[_("td",[t._v("/auth/register")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("注册接口，成功返回用户信息。")])]),t._v(" "),_("tr",[_("td",[t._v("/auth/password/reset")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("重置密码接口")])]),t._v(" "),_("tr",[_("td",[t._v("/like")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("返回句子赞的相关信息")])]),t._v(" "),_("tr",[_("td",[t._v("/like")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("提交赞，成功返回提交者 IP")])]),t._v(" "),_("tr",[_("td",[t._v("/like/cancel")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("撤回已经发出的喜爱")])]),t._v(" "),_("tr",[_("td",[t._v("/mark")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获取所有的审核标记")])]),t._v(" "),_("tr",[_("td",[t._v("/user")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获取用户信息")])]),t._v(" "),_("tr",[_("td",[t._v("/user/email/verify")]),t._v(" "),_("td",[t._v("PUT")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("申请验证邮箱")])]),t._v(" "),_("tr",[_("td",[t._v("/user/token")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("返回用户令牌的相关信息")])]),t._v(" "),_("tr",[_("td",[t._v("/user/token/refresh")]),t._v(" "),_("td",[t._v("PUT")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("重置令牌，返回新令牌的相关信息")])]),t._v(" "),_("tr",[_("td",[t._v("/user/password")]),t._v(" "),_("td",[t._v("PUT")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("修改密码")])]),t._v(" "),_("tr",[_("td",[t._v("/user/email")]),t._v(" "),_("td",[t._v("PUT")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("修改邮箱（未来行为可能发生变化）")])]),t._v(" "),_("tr",[_("td",[t._v("/user/notification/settings")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获取用户通知设置")])]),t._v(" "),_("tr",[_("td",[t._v("/user/notification/settings")]),t._v(" "),_("td",[t._v("PUT")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("设定用户通知设置，返回新设置")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/summary")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户一言提交数据的概览")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/like")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户赞的句子")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/history")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户历史的一言提交")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/history/pending")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户历史的一言提交（审核中部分）")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/history/refuse")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户历史的一言提交（已拒绝部分）")])]),t._v(" "),_("tr",[_("td",[t._v("/user/hitokoto/history/accept")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得用户历史的一言提交（已上线部分）")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/append")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("添加一言，返回审核队列中新句子的信息")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/:uuid")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("查看指定一言的信息（通过 UUID）")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/:uuid/mark")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("查看指定一言的审核标记（通过 UUID）")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/score")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("为已上线的句子评分，返回评分相关信息")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/score")]),t._v(" "),_("td",[t._v("GET")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("获得句子的评分信息")])]),t._v(" "),_("tr",[_("td",[t._v("/hitokoto/report")]),t._v(" "),_("td",[t._v("POST")]),t._v(" "),_("td",[t._v("Y")]),t._v(" "),_("td",[t._v("N")]),t._v(" "),_("td",[t._v("举报一言存在问题，返回提交举报的相关信息")])])])])])}),[],!1,null,null,null);v.default=a.exports}}]);